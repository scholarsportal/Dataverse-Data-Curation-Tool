<div class="fixed w-full surface on-surface-text flex flex-row justify-between">
    <!-- Filter Search -->
    <label class="my-auto sr-only">
        Search
    </label>
    <input matInput (keyup)="applyFilter($event)" placeholder="Search" class="table-search icon my-2" #input />
    <!-- Group Selection Dropdown -->
    <select *ngIf="selection.selected.length" name="groups" id=""
        class="bg-gray-100 border border-gray-300 rounded-md h-max p-1.5 my-auto">
        <option value="">Add to Group</option>
        <option *ngFor="let item of groups$ | async | keyvalue" id="{{ item.key }}" (click)="addToGroup(item.value)">{{
            getLabel(item.value) }}</option>
    </select>
    <button *ngIf="selection.selected.length && (selectedGroup$ | async)"
        class="bg-gray-100 h-max rounded-md border border-gray-300 p-1.5 my-auto" (click)="removeFromGroup()">
        Remove From Variable Group</button>
    <!-- Paginator -->
    <mat-paginator [pageSizeOptions]="[15, 30, 50, 100]" aria-label="Select variable page"></mat-paginator>
</div>
<div class="surface table-container top-0 mt-16">
    <table mat-table [dataSource]="vars" matSort class="surface ">
        <tr mat-header-row *matHeaderRowDef="columnMat; sticky: true"></tr>
        <tr mat-row *matRowDef="let row; columns: columnMat"></tr>

        <!-- TODO: THIS THROWS AN ERROR ON EMPTY DATASET -->
        <!-- Row shown when there is no matching data. -->
        <!-- <tr mat-row *matNoDataRow>
         <td mat-cell colspan="4">
         No data matching the filter "{{ input.value }}"
         </td>
         </tr> -->

        <!-- Checkbox Column -->
        <ng-container matColumnDef="check">
            <th mat-header-cell *matHeaderCellDef>
                <mat-checkbox (change)="$event ? toggleAllRows() : null"
                    [checked]="selection.hasValue() && isAllSelected()"
                    [indeterminate]="selection.hasValue() && !isAllSelected()" [aria-label]="checkboxLabel()">
                </mat-checkbox>
            </th>
            <td mat-cell *matCellDef="let row">
                <mat-checkbox (click)="$event.stopPropagation()"
                    (change)="$event ? selection.toggle(row['@_ID']) : null"
                    [checked]="selection.isSelected(row['@_ID'])" [aria-label]="checkboxLabel(row['@_ID'])">
                </mat-checkbox>
            </td>
        </ng-container>

        <!-- ID Column -->
        <ng-container matColumnDef="ID">
            <th mat-header-cell *matHeaderCellDef mat-sort-header="id">ID</th>
            <td mat-cell *matCellDef="let row">{{ row['@_ID'] }}</td>
        </ng-container>

        <!-- Name Column -->
        <ng-container matColumnDef="Name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header="name">Name</th>
            <td mat-cell *matCellDef="let row">{{ row['@_name'] }}</td>
        </ng-container>

        <!-- Label Column -->
        <ng-container matColumnDef="Label">
            <th mat-header-cell *matHeaderCellDef mat-sort-header="label">Label</th>
            <td mat-cell *matCellDef="let row">{{ row['labl']['#text'] }}</td>
        </ng-container>

        <!-- Weight Column -->
        <ng-container matColumnDef="Weight">
            <th mat-header-cell *matHeaderCellDef mat-sort-header="weight">Weight</th>
            <td mat-cell *matCellDef="let row">
                {{ row['@_wgt-var'] ? row['@_wgt-var'] : '' }}
            </td>
        </ng-container>

        <!-- View Column -->
        <ng-container matColumnDef="View">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>View</th>
            <td mat-cell *matCellDef="let row">
                <button (click)="viewChart(row)">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
                        <path
                            d="M18.375 2.25c-1.035 0-1.875.84-1.875 1.875v15.75c0 1.035.84 1.875 1.875 1.875h.75c1.035 0 1.875-.84 1.875-1.875V4.125c0-1.036-.84-1.875-1.875-1.875h-.75zM9.75 8.625c0-1.036.84-1.875 1.875-1.875h.75c1.036 0 1.875.84 1.875 1.875v11.25c0 1.035-.84 1.875-1.875 1.875h-.75a1.875 1.875 0 01-1.875-1.875V8.625zM3 13.125c0-1.036.84-1.875 1.875-1.875h.75c1.036 0 1.875.84 1.875 1.875v6.75c0 1.035-.84 1.875-1.875 1.875h-.75A1.875 1.875 0 013 19.875v-6.75z" />
                    </svg>
                </button>
            </td>
        </ng-container>

        <!-- Edit Column -->
        <ng-container matColumnDef="Edit">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Edit</th>
            <td mat-cell *matCellDef="let row">
                <button (click)="editVar(row)" class="mx-auto">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5">
                        <path
                            d="M21.731 2.269a2.625 2.625 0 00-3.712 0l-1.157 1.157 3.712 3.712 1.157-1.157a2.625 2.625 0 000-3.712zM19.513 8.199l-3.712-3.712-12.15 12.15a5.25 5.25 0 00-1.32 2.214l-.8 2.685a.75.75 0 00.933.933l2.685-.8a5.25 5.25 0 002.214-1.32L19.513 8.2z" />
                    </svg>
                </button>
            </td>
        </ng-container>
    </table>
</div>
<app-modal class="w-max">
    <!-- <div class="modal-header flex flex-col">
            <div class="text-2xl">{{ heading }}</div>
        </div>

        <div class="modal-body">
            <app-form *ngIf="isEditing$ | async; else chart"></app-form>
            <ng-template #chart>
                <app-chart class="w-full py-3"></app-chart>
            </ng-template>
        </div>

        <div class="modal-footer">
            <button (click)="close()">Update</button>
            <button (click)="close()">Cancel</button>
        </div> -->
</app-modal>
