{"ast":null,"code":"import { EventEmitter, ElementRef } from '@angular/core';\nimport { DdiService } from '../ddi.service';\nimport { TranslateService } from '@ngx-translate/core';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../ddi.service\";\nimport * as i2 from \"@ngx-translate/core\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/material/legacy-button\";\nimport * as i5 from \"@angular/material/icon\";\nimport * as i6 from \"@angular/material/legacy-form-field\";\nimport * as i7 from \"@angular/material/legacy-input\";\nimport * as i8 from \"@angular/material/legacy-list\";\nimport * as i9 from \"@angular/material/divider\";\nimport * as i10 from \"@angular/material/legacy-tooltip\";\nconst _c0 = [\"titleInput\"];\nfunction VarGroupComponent_a_13_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const tab_r1 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(tab_r1.varGrp.labl);\n  }\n}\nfunction VarGroupComponent_a_13_mat_form_field_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"mat-form-field\", 9)(1, \"input\", 10, 11);\n    i0.ɵɵlistener(\"keyup.enter\", function VarGroupComponent_a_13_mat_form_field_2_Template_input_keyup_enter_1_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const _r6 = i0.ɵɵreference(2);\n      const tab_r1 = i0.ɵɵnextContext().$implicit;\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.renameGroupComplete(tab_r1, _r6.value));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"span\", 12)(4, \"mat-icon\", 13);\n    i0.ɵɵlistener(\"click\", function VarGroupComponent_a_13_mat_form_field_2_Template_mat_icon_click_4_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const _r6 = i0.ɵɵreference(2);\n      const tab_r1 = i0.ɵɵnextContext().$implicit;\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.renameGroupComplete(tab_r1, _r6.value));\n    });\n    i0.ɵɵpipe(5, \"translate\");\n    i0.ɵɵtext(6, \"done\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(7, \"span\", 12)(8, \"mat-icon\", 13);\n    i0.ɵɵlistener(\"click\", function VarGroupComponent_a_13_mat_form_field_2_Template_mat_icon_click_8_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const tab_r1 = i0.ɵɵnextContext().$implicit;\n      const ctx_r12 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r12.renameGroupCancel(tab_r1));\n    });\n    i0.ɵɵpipe(9, \"translate\");\n    i0.ɵɵpipe(10, \"translate\");\n    i0.ɵɵtext(11, \"clear\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(12, \"span\", 12)(13, \"mat-icon\", 13);\n    i0.ɵɵlistener(\"click\", function VarGroupComponent_a_13_mat_form_field_2_Template_mat_icon_click_13_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const tab_r1 = i0.ɵɵnextContext().$implicit;\n      const ctx_r14 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r14.groupDelete(tab_r1));\n    });\n    i0.ɵɵpipe(14, \"translate\");\n    i0.ɵɵpipe(15, \"translate\");\n    i0.ɵɵtext(16, \"delete\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const tab_r1 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"value\", tab_r1.varGrp.labl);\n    i0.ɵɵadvance(3);\n    i0.ɵɵpropertyInterpolate(\"matTooltip\", i0.ɵɵpipeBind1(5, 7, \"GROUPS.SAVE\"));\n    i0.ɵɵattribute(\"aria-label\", \"GROUPS.DONE | translate\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵpropertyInterpolate(\"matTooltip\", i0.ɵɵpipeBind1(10, 11, \"GROUPS.CANCEL\"));\n    i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(9, 9, \"GROUPS.CANCEL\"));\n    i0.ɵɵadvance(5);\n    i0.ɵɵpropertyInterpolate(\"matTooltip\", i0.ɵɵpipeBind1(15, 15, \"GROUPS.DELETE\"));\n    i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(14, 13, \"GROUPS.DELETE\"));\n  }\n}\nfunction VarGroupComponent_a_13_button_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r19 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 14)(1, \"mat-icon\", 13);\n    i0.ɵɵlistener(\"click\", function VarGroupComponent_a_13_button_4_Template_mat_icon_click_1_listener() {\n      i0.ɵɵrestoreView(_r19);\n      const tab_r1 = i0.ɵɵnextContext().$implicit;\n      const ctx_r17 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r17.renameGroup(tab_r1));\n    });\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵpipe(3, \"translate\");\n    i0.ɵɵtext(4, \"edit\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"matTooltip\", i0.ɵɵpipeBind1(3, 4, \"GROUPS.EDIT\"));\n    i0.ɵɵattribute(\"aria-label\", i0.ɵɵpipeBind1(2, 2, \"GROUPS.EDIT\"));\n  }\n}\nconst _c1 = function (a0) {\n  return {\n    \"active\": a0\n  };\n};\nfunction VarGroupComponent_a_13_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r21 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"a\", 5);\n    i0.ɵɵlistener(\"click\", function VarGroupComponent_a_13_Template_a_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r21);\n      const tab_r1 = restoredCtx.$implicit;\n      const ctx_r20 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r20.onGroupClick(tab_r1));\n    })(\"dblclick\", function VarGroupComponent_a_13_Template_a_dblclick_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r21);\n      const tab_r1 = restoredCtx.$implicit;\n      const ctx_r22 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r22.onGroupDblClick(tab_r1));\n    });\n    i0.ɵɵtemplate(1, VarGroupComponent_a_13_span_1_Template, 2, 1, \"span\", 6);\n    i0.ɵɵtemplate(2, VarGroupComponent_a_13_mat_form_field_2_Template, 17, 17, \"mat-form-field\", 7);\n    i0.ɵɵelement(3, \"span\", 2);\n    i0.ɵɵtemplate(4, VarGroupComponent_a_13_button_4_Template, 5, 6, \"button\", 8);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const tab_r1 = ctx.$implicit;\n    i0.ɵɵpropertyInterpolate(\"id\", tab_r1.varGrp[\"@ID\"]);\n    i0.ɵɵproperty(\"disableRipple\", true)(\"ngClass\", i0.ɵɵpureFunction1(6, _c1, tab_r1.active));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !tab_r1.editable);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", tab_r1.editable);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", !tab_r1.editable);\n  }\n}\nexport let VarGroupComponent = /*#__PURE__*/(() => {\n  class VarGroupComponent {\n    constructor(ddiService, translate) {\n      this.ddiService = ddiService;\n      this.translate = translate;\n      this.allActive = true;\n      this.subSetRows = new EventEmitter();\n      this.parentScrollNav = new EventEmitter();\n      this.selectGroup = new EventEmitter();\n      this.disableSelectGroup = new EventEmitter();\n      this.groupChange = false;\n    }\n    ngOnInit() {}\n    // Add a new group to the list and scroll to show it\n    addTab() {\n      const numberOfGroups = this.variableGroups.length;\n      if (numberOfGroups === 0 || this.variableGroups[numberOfGroups - 1].varGrp.labl !== 'undefined' && this.variableGroups[numberOfGroups - 1].varGrp.labl.trim() !== '') {\n        // get the next id\n        const ids = [];\n        for (const i of this.variableGroups) {\n          ids.push(Number(i.varGrp['@ID'].substring(2)));\n        }\n        ids.sort();\n        let _id = 'VG';\n        if (ids.length > 0) {\n          _id += String(ids[ids.length - 1] + 1);\n        } else {\n          _id += '1';\n        }\n        const varGroup = {};\n        varGroup.varGrp = {\n          labl: '',\n          '@var': '',\n          '@ID': _id\n        };\n        varGroup.varGrp['@var'] = '';\n        this.variableGroups.push(varGroup);\n        const obj = this;\n        obj.variableGroups[numberOfGroups].editable = true;\n        this.groupChange = true;\n        console.log(\"group Change \" + this.groupChange);\n        setTimeout(() => {\n          obj.titleInput.nativeElement.focus();\n          obj.parentScrollNav.emit();\n          obj.onGroupClick(varGroup);\n        }, 100);\n      }\n    }\n    onGroupClick(_obj) {\n      this.ddiService.clearSearch();\n      const obj = _obj;\n      const vars = obj.varGrp['@var'].split(' ');\n      this.subSetRows.emit(vars);\n      this.showActive(obj.varGrp['@ID']);\n      this.selectGroup.emit(obj.varGrp['@ID']);\n    }\n    onGroupDblClick(_obj) {\n      this.renameGroup(_obj);\n    }\n    renameGroup(_obj) {\n      _obj.editable = true;\n    }\n    renameGroupComplete(_obj, _val) {\n      if (_val !== null && _val.trim() !== '') {\n        _obj.varGrp.labl = _val.trim();\n        _obj.editable = false;\n      }\n      this.groupChange = true;\n    }\n    renameGroupCancel(_obj) {\n      if (_obj.varGrp.labl !== null && _obj.varGrp.labl.trim() !== '') {\n        _obj.editable = false;\n      }\n    }\n    groupDelete(_obj) {\n      //if (confirm('Are you sure you want to delete ' + _obj.varGrp['labl'] + '?')) {\n      if (confirm(this.translate.instant('TS.CONFIRM') + _obj.varGrp['labl'] + '?')) {\n        for (let i = 0; i < this.variableGroups.length; i++) {\n          if (this.variableGroups[i].varGrp['@ID'] === _obj.varGrp['@ID']) {\n            this.variableGroups.splice(i, 1);\n          }\n        }\n        this.showAll();\n        this.groupChange = true;\n      } else {\n        _obj.editable = false;\n      }\n    }\n    showActive(_id) {\n      this.allActive = false;\n      // show it's active\n      for (const i of this.variableGroups) {\n        if (i.varGrp['@ID'] === _id) {\n          i.active = true;\n        } else {\n          i.active = false;\n        }\n      }\n    }\n    showAll() {\n      this.ddiService.clearSearch();\n      this.showActive();\n      this.allActive = true;\n      this.subSetRows.emit();\n      this.disableSelectGroup.emit();\n    }\n    static #_ = this.ɵfac = function VarGroupComponent_Factory(t) {\n      return new (t || VarGroupComponent)(i0.ɵɵdirectiveInject(i1.DdiService), i0.ɵɵdirectiveInject(i2.TranslateService));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: VarGroupComponent,\n      selectors: [[\"app-var-group\"]],\n      viewQuery: function VarGroupComponent_Query(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵviewQuery(_c0, 5);\n        }\n        if (rf & 2) {\n          let _t;\n          i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.titleInput = _t.first);\n        }\n      },\n      inputs: {\n        variableGroups: \"variableGroups\"\n      },\n      outputs: {\n        subSetRows: \"subSetRows\",\n        parentScrollNav: \"parentScrollNav\",\n        selectGroup: \"selectGroup\",\n        disableSelectGroup: \"disableSelectGroup\"\n      },\n      decls: 14,\n      vars: 10,\n      consts: [[1, \"groups-list\"], [\"mat-list-item\", \"\", 1, \"button-header\", 3, \"click\"], [1, \"fill-space\"], [\"mat-list-item\", \"\", 3, \"ngClass\", \"click\"], [\"mat-list-item\", \"\", 3, \"id\", \"disableRipple\", \"ngClass\", \"click\", \"dblclick\", 4, \"ngFor\", \"ngForOf\"], [\"mat-list-item\", \"\", 3, \"id\", \"disableRipple\", \"ngClass\", \"click\", \"dblclick\"], [4, \"ngIf\"], [\"class\", \"fixed_width\", 4, \"ngIf\"], [\"mat-icon-button\", \"\", \"color\", \"primary\", 4, \"ngIf\"], [1, \"fixed_width\"], [\"matInput\", \"\", \"maxLength\", \"50\", 3, \"value\", \"keyup.enter\"], [\"titleInput\", \"\"], [\"button\", \"\", \"mat-icon-button\", \"\", \"matSuffix\", \"\", \"color\", \"primary\"], [3, \"matTooltip\", \"click\"], [\"mat-icon-button\", \"\", \"color\", \"primary\"]],\n      template: function VarGroupComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"mat-nav-list\", 0)(1, \"a\", 1);\n          i0.ɵɵlistener(\"click\", function VarGroupComponent_Template_a_click_1_listener() {\n            return ctx.addTab();\n          });\n          i0.ɵɵelementStart(2, \"span\");\n          i0.ɵɵtext(3);\n          i0.ɵɵpipe(4, \"translate\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(5, \"span\", 2);\n          i0.ɵɵelementStart(6, \"mat-icon\");\n          i0.ɵɵtext(7, \"add\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelement(8, \"mat-divider\");\n          i0.ɵɵelementStart(9, \"a\", 3);\n          i0.ɵɵlistener(\"click\", function VarGroupComponent_Template_a_click_9_listener() {\n            return ctx.showAll();\n          });\n          i0.ɵɵtext(10);\n          i0.ɵɵpipe(11, \"translate\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(12, \"mat-divider\");\n          i0.ɵɵtemplate(13, VarGroupComponent_a_13_Template, 5, 8, \"a\", 4);\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(3);\n          i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(4, 4, \"GROUPS.ADD\"));\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(8, _c1, ctx.allActive));\n          i0.ɵɵadvance(1);\n          i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(11, 6, \"GROUPS.ALLVAR\"));\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngForOf\", ctx.variableGroups);\n        }\n      },\n      dependencies: [i3.NgClass, i3.NgForOf, i3.NgIf, i4.MatLegacyButton, i5.MatIcon, i6.MatLegacyFormField, i6.MatLegacySuffix, i7.MatLegacyInput, i8.MatLegacyNavList, i8.MatLegacyListItem, i9.MatDivider, i10.MatLegacyTooltip, i2.TranslatePipe],\n      styles: [\".groups-list[_ngcontent-%COMP%]{padding-top:0}\"]\n    });\n  }\n  return VarGroupComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}